version: "3.2"
services:
  #-----------------------------------------
  # web server
  #-----------------------------------------
  web:
    build:
      context: ./nginx/
    container_name: "web"
    volumes:
      - ./nginx:/data
    ports:
     - "8080:80"
    depends_on:
      - ap

  #-----------------------------------------
  # ap server
  #-----------------------------------------
  ap:
    build:
      context: ./rails/
    container_name: "ap"
    volumes:
      - ./rails:/data
    command: bash -c "bundle install && bundle exec pumactl start"
